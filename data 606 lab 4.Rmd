---
title: "Data 606 lab 4"
author: "Yina Qiao"
date: "2023-03-04"
output: html_document
---
## Load packages

```{r}
knitr::opts_chunk$set(eval = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(openintro)
```

## Load Data
```{r}
data("fastfood", package='openintro')
head(fastfood)
glimpse(fastfood)
```

### Exercise 1   

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Make a plot (or plots) to visualize the distributions of the amount of calories from fat of the options from these two restaurants. How do their centers, shapes, and spreads compare?

</div> \hfill\break

Each set is unimodal and right skewed (the tail runs to the right). The unique differences between the distributions - McDonald's has a higher minimum, maximum and mean / center for fat calories, *and* the McDonald's x axis increases in increments of 200 cals while the Dairy Queen one increases in increments of 100 cals. 

```{r}

mcdonalds <- fastfood %>%
  filter(restaurant == "Mcdonalds")
dairy_queen <- fastfood %>%
  filter(restaurant == "Dairy Queen")

summary(mcdonalds$cal_fat)
hist(mcdonalds$cal_fat)

summary(dairy_queen$cal_fat)
hist(dairy_queen$cal_fat)

```


### Exercise 2

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Based on the plot (below), does it appear that the data follow a nearly normal distribution?

</div> \hfill\break

Yes.  It appears that the data follow a nearly normal distribution, the peaks are much higher and more spread our as they approach 0 (in density), and there's a high density to the far right. With that said, there is a central peak ~220 cal_fat and the distribution does approach 0 (in density) near the min and max cal_fat values so the case can be made that it is a normal distribution.

```{r}

dqmean = mean(dairy_queen$cal_fat)
dqsd = sd(dairy_queen$cal_fat)

ggplot(data = dairy_queen, aes(x = cal_fat)) +
        geom_blank() +
        geom_histogram(aes(y = ..density..)) +
        stat_function(fun = dnorm, args = c(mean = dqmean, sd = dqsd), col = "tomato")
```


### Exercise 3

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Make a normal probability plot of sim_norm. Do all of the points fall on the line? How does this plot compare to the probability plot for the real data? (Since sim_norm is not a dataframe, it can be put directly into the sample argument and the data argument can be dropped.)

</div> \hfill\break

No, all of the points do not fall on the line. The probability plots for the simulated v real data are similar but not the same. The real data has a lesser slope from -2 to -1 and a greater slope from 1 to 2. Other than that nuance, the plots are very similar.

```{r}
#Construct a normal probability (Q-Q) plot
ggplot(data = dairy_queen, aes(sample = cal_fat)) + 
  geom_line(stat = "qq")

#Simulate data from a normal distribution
sim_norm <- rnorm(n = nrow(dairy_queen), mean = dqmean, sd = dqsd)

#Plot the simulated data
ggplot(data = NULL, aes(sample = sim_norm)) +
  geom_line(stat = "qq")

```


### Exercise 4

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Does the normal probability plot for the calories from fat look similar to the plots created for the simulated data? That is, do the plots provide evidence that the cal_fat are nearly normal?

</div> \hfill\break

Per lab text: *A data set that is nearly normal will result in a probability plot where the points closely follow a diagonal line. Any deviations from normality lead to deviations of these points from that line.*

The Dairy Queen cal_fat data (plotted below) is nearly normal. It closely follows a diagonal line and is incredibly similar to the plots generated by qqnormsim (ie. sim 7).

```{r}
qqnormsim(sample = cal_fat, data = dairy_queen)
```

### Exercise 5

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Using the same technique, determine whether or not the calories from McDonald’s menu appear to come from a normal distribution.

</div> \hfill\break

The McDonald’s cal_fat data (plotted below) is nearly normal. Although the slope is rather small near the beginning and rather larger later on, it does form a diagonal line and closely mimics a couple of the simulated plots up until these higher values (ie. sim 1 or 3).

```{r}
qqnormsim(sample = cal_fat, data = mcdonalds)
```

### Exercise 6

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Write out two probability questions that you would like to answer about any of the restaurants in this dataset. Calculate those probabilities using both the theoretical normal distribution as well as the empirical distribution (four probabilities in all). Which one had a closer agreement between the two methods?

</div> \hfill\break

**Question 1: ** What is the probability that a randomly chosen Arby's product has more than 20g's of protein?

```{r}

#Arby's >20gs protein calculations: 
arbys <- fastfood %>%
  filter(restaurant == "Arbys")

a_mean <- mean(arbys$protein)
a_sd <- sd(arbys$protein)

1 - pnorm(q = 20, mean = a_mean, sd = a_sd)

arbys %>% 
  filter(protein > 20) %>%
  summarise(percent = n() / nrow(arbys))

```

**Question 2: ** What is the probability that a randomly chosen product from any of these fast food restaurants is less than 1000 calories?

```{r}
#< 1000 cals calculations: 

ff_mean <- mean(fastfood$calories)
ff_sd <- sd(fastfood$calories)

pnorm(q = 1000, mean = ff_mean, sd = ff_sd)

fastfood %>% 
  filter(calories < 1000) %>%
  summarise(percent = n() / nrow(fastfood))

```



### Exercise 7

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Now let’s consider some of the other variables in the dataset. Out of all the different restaurants, which ones’ distribution is the closest to normal for sodium?

</div> \hfill\break

Based on the plots below, **Burger King and Chick Fil-A** had the distributions closest to normal for sodium.

```{r}
#Arbys sodium plot
arbys <- fastfood %>%
  filter(restaurant == "Arbys")

qqnorm(arbys$sodium, main = "Arbys")

#Burger King sodium plot
bk <- fastfood %>%
  filter(restaurant == "Burger King")

qqnorm(bk$sodium, main = "Burger King")

#Chick Fil-A sodium plot **
cfa <- fastfood %>%
  filter(restaurant == "Chick Fil-A")

qqnorm(cfa$sodium, main = "Chick Fil-A")

#Dairy Queen sodium plot
dq <- fastfood %>%
  filter(restaurant == "Dairy Queen")

qqnorm(dq$sodium, main = "Dairy Queen")

#McDonald's sodium plot
mcd <- fastfood %>%
  filter(restaurant == "Mcdonalds")

qqnorm(mcd$sodium, main = "McDonald's")

#Sonic sodium plot
s <- fastfood %>%
  filter(restaurant == "Sonic")

qqnorm(s$sodium, main = "Sonic")

#Subway sodium plot
sw <- fastfood %>%
  filter(restaurant == "Subway")

qqnorm(sw$sodium, main = "Subway")

#Taco Bell sodium plot
tb <- fastfood %>%
  filter(restaurant == "Taco Bell")

qqnorm(tb$sodium, main = "Taco Bell")

```


### Exercise 8

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

Note that some of the normal probability plots for sodium distributions seem to have a stepwise pattern. why do you think this might be the case?

</div> \hfill\break

The stepwise pattern could due to these restaurants offer a variety of products (ie. french fries, soft drinks, sandwiches, salads) and the sodium content across these different food groups could varies considerably

### Exercise 9

<style>
div.blue { background-color:#e6f0ff; border-radius: 5px; padding: 20px;}
</style>
<div class = "blue">

As you can see, normal probability plots can be used both to assess normality and visualize skewness. Make a normal probability plot for the total carbohydrates from a restaurant of your choice. Based on this normal probability plot, is this variable left skewed, symmetric, or right skewed? *Use a histogram to confirm your findings.*

</div> \hfill\break

Based on the normal probability plot (below), this variable (total carbohydrates) is right skewed and the histogram confirms this with data being concentrated on the left with a tail running to the right.

```{r}
#Normal plot for total carbohydrates from Dairy Queen
qqnorm(dq$total_carb, main = "Dairy Queen Carbs")
qqline(dq$total_carb)

#Use a histogram to confirm.
hist(dq$total_carb)
```